<!--
Copyright 2014 Space Dynamics Laboratory - Utah State University Research Foundation.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!-- Results Container -->
<div class='container-fluid' style="margin-top: 0px;">
  <!-- Filters Div -->
  <div id="filters" class="filters filterBack">
    <loader trigger="filtersLoad"></loader>

    <div class="filterTableDiv firstFilter">
      <label for="searchFilter">Sort By: </label>
      <select ng-model="orderProp" class="form-control">
        <option class="hidden-lg" selected disabled value="" hidden>Sort By</option>
        <option value="+name">Name (A-Z)</option>
        <option value="-name">Name (Z-A)</option>
        <option value="-stats.averageRating">Rating (high-low)</option>
        <option value="+stats.averageRating">Rating (low-high)</option>
        <option value="+updateDate">Last Update (newest)</option>
        <option value="-updateDate">Last Update (oldest)</option>
      </select>
      <br>
      <label for="searchFilter">Filter By Text: </label>
      <input type="text" id="searchFilter" class="form-control" placeholder="Search" ng-model="query" ng-options="key for key in typeahead" bs-typeahead/>
      <br>
      <label for="tagsFilter">Filter By Tag: </label>
      <tags-input class="bootstrap" min-length="1" ng-model="tagsFilter" replace-spaces-with-dashes="false" add-from-autocomplete-only="true" on-tag-added="applyFilters();" on-tag-removed="applyFilters();"><auto-complete min-length="1" source="checkTagsList($query, tagsFilter, tagsList)"></auto-complete></tags-input>
      <br>
      <label for="ratingsFilter">Filter By Rating: </label>
      <br>
      <raty class="average-raty" id="filterRating" style="min-width:110px; height: 100%;" score="{{ratingsFilter}}" ng-model="ratingsFilter" number="5" path="images/raty/">
      </raty>
    </div>


    <!-- Added these divs for the ability to dynamically make the filters an accordian -->

    <div class='filterTableDiv filterTable'>

      <label for="accordian">Filter By Attribute: </label>
      <div class="pane-group" id="accordion">
        <div ng-class="$last? 'lastFilter': ''" class="panel panel-default" class="filterTableDiv" ng-repeat="filter in filters">
          <table class="table">
            <tr ng-class="filters.length > 2? 'panel-heading': ''">
              <th ng-class="filters.length > 2? 'panel-title':''" class="filtersTd filtersTh" ><span class="btn btn-link " data-toggle="collapse" data-parent="#accordion" href="#collapse{{$index}}" style="max-width: 152px; padding-left: 0px;"><span class="overflow-pair-right">&nbsp;<i class="fa fa-caret-down"></i></span><span class="overflow-pair-left" style="text-align: left;">{{filter.name}}</span></span><input type="checkbox" ng-model="filter.checked" ng-change="toggleChecks(filter.collection)" /><small ng-show="filter.hasChecked">&nbsp;(applied)</small></th>
            </tr>
            <tbody ng-class="filters.length > 2? $first? 'panel-collapse collapse in': 'panel-collapse collapse':''" id="collapse{{$index}}">
              <tr  class="filtersTr" data-ng-repeat="type in filter.collection" >
                <td ng-class="filters.length > 2? 'panel-body': ''" class="filtersTd">
                  <div class="checkbox filterCheckbox">
                    <input type="checkbox" ng-checked="type.checked" ng-model="type.checked" id="{{type.type}}" ng-change="applyFilters()"/>
                    <label for="{{type.type}}">{{type.type}}</label>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="lastFilter">
      <button class="btn red btn-default col-sm-12" ng-click="clearFilters()">Clear Filters</button>
    </div>
  </div>
  <!-- END Filters Div -->

  <!-- Page 1 -->
  <div class='page1'>
    <loader trigger="mainLoader"></loader>
    
    <!-- Placeholder for the pagination controls -->
    <div class="pagination row row-centered">
      <div style="text-align: center;">
        <span class="glyphicon glyphicon-fast-backward imitateLink" ng-click="pageNumber=1">&nbsp;</span>
        <span class="glyphicon glyphicon-chevron-left imitateLink" ng-click="pageNumber=pageNumber-1">&nbsp;</span>
        <span class="imitateLink"> Page </span>
        <span class="imitateLink"> 
          <input type="text"  data-default="1" ng-model="pageNumber" min="1" max="{{maxPageNumber}}" style="width:21px">
        </span>
        <span class="imitateLink"> of </span>
        <span class="imitateLink" ng-bind="maxPageNumber"></span>
        <span class="glyphicon glyphicon-chevron-right imitateLink" ng-click="pageNumber=pageNumber+1">&nbsp;</span>
        <span class="glyphicon glyphicon-fast-forward imitateLink"  ng-click="pageNumber=maxPageNumber">&nbsp;</span>          
        <span class="imitateLink"> 
          <input type="text" data-default="10" ng-model="rowsPerPage" style="width:25px" min="1"> Per page
        </span> 
      </div>
    </div>
    <!-- End Placeholder for the pagination controls -->
    <div class="showPage" id="filtersButton" onclick="openFiltersToggle()">
      <button  class=" btn btn-primary filtersButton">
        Filters <i class="fa fa-caret-left"></i> 
      </button>
    </div>
    <div class="showPage" ng-show="showDetails">
      <button id="showPageRight" class="showPageRight btn btn-primary" ng-click="doButtonOpen()">
        <i class="fa fa-caret-left"></i> 
      </button>
    </div>
    <div ng-if="data.length == 0">
      {{noDataMessage}}
    </div>
    <div class="page1Content" ng-if="data.length > 0">
      <div class='container-fluid results'>
        <div>
          <div class="searchTitle">
            Search &mdash; {{searchTitle}}
          </div>
          <div class="searchDescription">
            <!-- fa fa-file-text, fa fa-book, fa fa-info-circle-->
            <!-- glyphicon glyphicon-info-sign -->
            <span ng-click="setupModal(modal, ''); openModal('descModal'); " class="imitateLink" > {{searchDescription}} <i class="glyphicon glyphicon-info-sign"></i></span>
          </div>
        </div>
        <component-list click-callback="updateDetails" class-list="" data="data" cols="3" ></component-list>
      </div>
    </div>
  </div>
  <!-- End Page 1 -->
  <!-- <p class=''>how's it going? </p> -->
  <!-- Page 2 -->
  <!--         <a href="javascript: void(0)" data-toggle="modal" data-target="#basicModal2">DI2E Evaluation Level</a> --> 
  <div class='page2'>
    <div ng-include="'views/details/fulldetails.html'"></div>
  </div>
  <!-- End Page 2 -->

  <!-- This is replaced with a div that triggers the dom manipulation elements -->
  <!-- This is the best way to handle these kind of things with angular... -->
  <div broadcast-results></div>

</div>
<!-- End Results Container -->


<!-- build:css({.tmp,app}) styles/results.css -->
<link rel="stylesheet" href="styles/results.css">
<!-- endbuild -->
